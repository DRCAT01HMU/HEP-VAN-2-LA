<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper-Infographic Chuyên Sâu: Hẹp Van Hai Lá</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Refined Teal and Warm Neutrals (Detailed Static & Animated) -->
    <!-- Application Structure Plan: A more detailed, static, offline-first version. New sections for Clinical Presentation, Classic Diagnostics (ECG/CXR), and Complications are added. The structure is reorganized for a more logical clinical workflow. All AI content is pre-rendered. Animations are refined to be more fluid and storytelling-oriented. -->
    <!-- Visualization & Content Choices: New visualizations for ECG (P mitrale) and CXR (double density, Kerley B lines) are created using HTML/CSS. The treatment section is expanded. The overall goal is to create a definitive, visually rich, offline educational resource. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            padding-bottom: 8px;
        }
        .nav-button.active, .nav-button:hover {
            color: #0f766e;
            border-bottom-color: #0f766e;
        }
        .tab-button.active {
            background-color: #0f766e;
            color: white;
        }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .chart-container {
            position: relative; width: 100%; max-width: 700px; margin-left: auto; margin-right: auto; height: 350px; max-height: 450px;
        }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        
        .animated-child {
            opacity: 0;
            transform: translateY(25px);
            transition: opacity 0.7s ease-out, transform 0.7s ease-out;
            transition-delay: var(--delay, 0s);
        }
        .animated-child.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .interactive-card {
            transition: all 0.3s ease;
        }
        .interactive-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 24px rgba(30, 41, 59, 0.1);
        }

        .cascade-connector {
            position: relative; height: 3rem; width: 2px; margin: -1rem auto;
            background-color: #cbd5e1; transform: scaleY(0);
            transform-origin: top; transition: transform 0.5s ease-out;
            transition-delay: var(--delay, 0s);
        }
        .cascade-connector.visible { transform: scaleY(1); }
        .cascade-arrow {
            position: absolute; bottom: -1px; left: 50%;
            transform: translateX(-50%); width: 0; height: 0;
            border-left: 6px solid transparent; border-right: 6px solid transparent;
            border-top: 8px solid #cbd5e1;
        }
        .ai-content-box {
            background-color: #f0f9ff; border-left: 4px solid #0ea5e9;
            margin-top: 1rem; padding: 1rem; border-radius: 0 8px 8px 0;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4">
            <div class="flex items-center justify-between h-20">
                <h1 class="text-xl md:text-2xl font-bold text-[#005f69]">Hẹp Van Hai Lá: Chuyên Sâu</h1>
                <div class="hidden md:flex items-center space-x-6 text-base font-semibold text-gray-500">
                    <button class="nav-button active" data-target="overview">Tổng quan</button>
                    <button class="nav-button" data-target="clinical">Lâm sàng</button>
                    <button class="nav-button" data-target="diagnostics">Cận lâm sàng</button>
                    <button class="nav-button" data-target="staging">Phân loại</button>
                    <button class="nav-button" data-target="complications">Biến chứng</button>
                    <button class="nav-button" data-target="treatment">Điều trị</button>
                </div>
                <div class="md:hidden">
                    <select id="mobile-nav" class="bg-white border border-gray-300 rounded-md p-2 text-gray-700 focus:ring-2 focus:ring-[#0f766e]">
                        <option value="overview">Tổng quan</option>
                        <option value="clinical">Lâm sàng</option>
                        <option value="diagnostics">Cận lâm sàng</option>
                        <option value="staging">Phân loại</option>
                        <option value="complications">Biến chứng</option>
                        <option value="treatment">Điều trị</option>
                    </select>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <section id="overview" class="content-section active">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Sinh Lý Bệnh & Nguyên Nhân</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Hẹp van hai lá khởi đầu một chuỗi biến đổi huyết động, từ tắc nghẽn cơ học tại van đến suy tim toàn bộ.</p>
            </div>
            
            <div id="pathophysiology-cascade" class="space-y-0 mb-16 animated-parent">
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child">
                    <h3 class="font-semibold text-gray-800">1. Hẹp Van</h3><p class="text-sm text-gray-500">Cản trở dòng máu từ nhĩ trái xuống thất trái</p></div>
                <div class="cascade-connector animated-child" style="--delay: 0.2s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.3s;">
                    <h3 class="font-semibold text-gray-800">2. Tăng Áp Lực Nhĩ Trái</h3><p class="text-sm text-gray-500">Gây giãn nhĩ, nguy cơ rung nhĩ & huyết khối</p></div>
                <div class="cascade-connector animated-child" style="--delay: 0.5s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.6s;">
                    <h3 class="font-semibold text-gray-800">3. Tăng Áp Phổi</h3><p class="text-sm text-gray-500">Gây khó thở, sung huyết phổi</p></div>
                <div class="cascade-connector animated-child" style="--delay: 0.8s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.9s;">
                    <h3 class="font-semibold text-gray-800">4. Suy Thất Phải</h3><p class="text-sm text-gray-500">Gây phù, gan to, tĩnh mạch cổ nổi</p></div>
            </div>
        </section>

        <section id="clinical" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Chẩn Đoán Lâm Sàng</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Nhận biết các triệu chứng cơ năng và thực thể là bước đầu tiên và quan trọng nhất trong chẩn đoán.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Triệu chứng Cơ năng</h3>
                    <ul class="space-y-2 text-slate-600 list-disc list-inside">
                        <li><strong>Khó thở khi gắng sức:</strong> Triệu chứng sớm và phổ biến nhất.</li>
                        <li><strong>Ho ra máu:</strong> Do vỡ các tĩnh mạch phế quản dưới áp lực cao.</li>
                        <li><strong>Khàn tiếng (Hội chứng Ortner):</strong> Do nhĩ trái giãn lớn chèn ép dây thần kinh.</li>
                        <li><strong>Hồi hộp, đánh trống ngực:</strong> Thường do rung nhĩ.</li>
                        <li><strong>Biến chứng tắc mạch:</strong> Đột quỵ, tắc mạch chi...</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Dấu hiệu Thực thể</h3>
                    <ul class="space-y-2 text-slate-600 list-disc list-inside">
                        <li><strong>Nhìn:</strong> Dấu hiệu "má hồng" (mitral facies).</li>
                        <li><strong>Sờ:</strong> Rung miu tâm trương ở mỏm tim.</li>
                        <li><strong>Nghe:</strong> Tam chứng kinh điển:
                            <ul class="pl-6 mt-1 space-y-1">
                                <li><strong>T1 đanh</strong> ở mỏm.</li>
                                <li><strong>Clac mở van hai lá</strong> đầu tâm trương.</li>
                                <li><strong>Rung tâm trương</strong> ở mỏm.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="diagnostics" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Chẩn Đoán Cận Lâm Sàng</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Từ các công cụ kinh điển đến hình ảnh học tiên tiến, mỗi phương pháp cung cấp một mảnh ghép quan trọng.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Điện tâm đồ (ECG)</h3>
                    <p class="mb-4 text-slate-600">ECG cho thấy các dấu hiệu gián tiếp của dày nhĩ trái và thất phải.</p>
                    <div class="border-t pt-4">
                        <p class="font-semibold">Dấu hiệu P hai lá (P mitrale):</p>
                        <p class="text-sm text-slate-500">Sóng P rộng > 0.12s và có 2 đỉnh ở DII.</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">X-quang ngực thẳng</h3>
                    <p class="mb-4 text-slate-600">Hình ảnh tim-phổi phản ánh tình trạng ứ huyết và thay đổi cấu trúc buồng tim.</p>
                    <ul class="space-y-1 text-slate-600 list-disc list-inside text-sm">
                        <li>Bờ đôi nhĩ trái (dấu hiệu "double density").</li>
                        <li>Xóa cung giữa bờ trái tim.</li>
                        <li>Đường Kerley B ở góc sườn hoành.</li>
                        <li>Cung động mạch phổi nổi.</li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 animated-parent">
                 <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Siêu âm tim</h3>
                    <p class="text-slate-600">Là công cụ không thể thiếu, xác định chẩn đoán, mức độ nặng và cơ chế bệnh.</p>
                    <button class="font-semibold text-[#0f766e] mt-2 diagnostic-details-btn" data-target="echo-details">Xem chi tiết 2D vs 3D →</button>
                    <div id="echo-details" class="hidden mt-4 bg-gray-50 p-4 rounded-lg">
                        <h4 class="text-lg font-bold text-center mb-2">Tại sao Siêu âm 3D vượt trội hơn 2D?</h4>
                        <p class="text-center text-sm">Siêu âm 2D thường cắt chéo qua lỗ van, làm diện tích đo được lớn hơn thực tế. Siêu âm 3D cho phép tái tạo hình ảnh và xác định chính xác mặt phẳng hẹp nhất, là "tiêu chuẩn vàng mới".</p>
                    </div>
                 </div>
            </div>
        </section>

        <section id="staging" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Phân Giai Đoạn & Mức Độ Nặng</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Hệ thống phân giai đoạn A-D của AHA/ACC giúp chuẩn hóa việc đánh giá và định hướng can thiệp.</p>
            </div>
            <div class="flex flex-col md:flex-row gap-8 animated-parent" data-tab-container="staging">
                <div class="md:w-1/3 animated-child">
                    <div class="flex flex-col bg-white rounded-lg shadow-lg overflow-hidden">
                        <button class="tab-button p-4 text-left w-full text-lg active" data-target="stageA"><strong>A:</strong> Có nguy cơ</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageB"><strong>B:</strong> Tiến triển</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageC"><strong>C:</strong> Nặng, không triệu chứng</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageD"><strong>D:</strong> Nặng, có triệu chứng</button>
                    </div>
                </div>
                <div class="md:w-2/3 bg-white p-8 rounded-lg shadow-lg animated-child" style="--delay: 0.1s;">
                    <div id="stageA" class="staging-content"><h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn A: At Risk</h3><p><strong>Đặc điểm:</strong> Có yếu tố nguy cơ (tiền sử thấp tim) nhưng van bình thường. <strong>Xử trí:</strong> Theo dõi, phòng thấp tái phát.</p></div>
                    <div id="stageB" class="staging-content hidden"><h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn B: Progressive</h3><p><strong>Đặc điểm:</strong> HHL nhẹ đến vừa (MVA > 1.5 cm²). <strong>Xử trí:</strong> Theo dõi siêu âm tim định kỳ (1-5 năm).</p></div>
                    <div id="stageC" class="staging-content hidden"><h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn C: Asymptomatic Severe</h3><p><strong>Đặc điểm:</strong> HHL khít (MVA ≤ 1.5 cm²). <strong>Xử trí:</strong> Theo dõi sát. Cân nhắc can thiệp sớm nếu có yếu tố nguy cơ cao.</p></div>
                    <div id="stageD" class="staging-content hidden"><h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn D: Symptomatic Severe</h3><p><strong>Đặc điểm:</strong> HHL khít (MVA ≤ 1.5 cm²) và có triệu chứng. <strong>Xử trí:</strong> Có chỉ định can thiệp rõ ràng.</p></div>
                </div>
            </div>
             <div class="mt-12 bg-white p-6 rounded-lg shadow-lg animated-parent">
                <h3 class="text-3xl font-bold text-center text-[#0f766e] mb-6 animated-child">Đánh giá Mức độ nặng trên Siêu âm</h3>
                <div class="chart-container animated-child" style="--delay: 0.1s;"><canvas id="severityChart"></canvas></div>
            </div>
        </section>

        <section id="complications" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Các Biến Chứng Chính</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Hẹp van hai lá có thể dẫn đến nhiều biến chứng nghiêm trọng nếu không được điều trị kịp thời.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Rung nhĩ & Huyết khối</h3>
                    <p class="text-slate-600">Là biến chứng thường gặp nhất. Sự ứ trệ máu trong nhĩ trái giãn lớn tạo điều kiện hình thành cục máu đông, có thể gây đột quỵ.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Tăng áp phổi & Suy tim phải</h3>
                    <p class="text-slate-600">Áp lực cao kéo dài ở phổi làm tổn thương mạch máu phổi và gây quá tải cho buồng tim phải, dẫn đến suy tim phải không hồi phục.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.2s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Phù phổi cấp</h3>
                    <p class="text-slate-600">Một cấp cứu nội khoa. Xảy ra khi áp lực trong mao mạch phổi tăng quá cao, làm dịch thoát vào phế nang, gây suy hô hấp cấp.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.3s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Viêm nội tâm mạc nhiễm khuẩn</h3>
                    <p class="text-slate-600">Van tim bị tổn thương là nơi vi khuẩn dễ bám vào và phát triển, gây nhiễm trùng nặng và phá hủy thêm cấu trúc van.</p>
                </div>
            </div>
        </section>
        
        <section id="treatment" class="content-section">
             <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Chiến Lược Điều Trị</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Từ điều trị nội khoa đến các can thiệp tiên tiến, mục tiêu là giảm triệu chứng và cải thiện tiên lượng.</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Nội khoa & Chống đông</h3>
                    <p class="mb-4">Nền tảng trong kiểm soát triệu chứng và phòng ngừa biến chứng tắc mạch, đặc biệt khi có rung nhĩ.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Nong van bằng bóng (PMBC)</h3>
                    <p class="mb-4">Lựa chọn hàng đầu cho HHL do thấp có hình thái van phù hợp (điểm Wilkins ≤ 8).</p>
                    <div id="wilkins-calculator" class="space-y-2">
                        <div class="grid grid-cols-2 gap-4">
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Di động: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Độ dày: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Vôi hóa: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Dưới van: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                        </div>
                        <div id="wilkins-result" class="text-center font-bold text-lg p-3 rounded-md mt-2"></div>
                    </div>
                </div>
                <div class="bg-white p-8 rounded-lg shadow-lg lg:col-span-2 interactive-card animated-child" style="--delay: 0.2s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Phẫu thuật Sửa hoặc Thay van</h3>
                    <p class="mb-4">Chỉ định khi PMBC không phù hợp. Lựa chọn giữa sửa van, thay van cơ học và sinh học là một quyết định phức tạp, cần cá thể hóa.</p>
                </div>
            </div>
        </section>
        
        <section id="special" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Tình Huống Đặc Biệt</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Quản lý HHL cần được điều chỉnh cẩn thận ở một số quần thể đặc biệt.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-8 rounded-lg shadow-xl interactive-card animated-child">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">🤰 Thai kỳ</h3>
                    <p class="text-gray-700">Tình trạng nguy cơ rất cao. Cần tư vấn và can thiệp (nếu có chỉ định) <strong>TRƯỚC KHI</strong> mang thai.</p>
                </div>
                <div class="bg-white p-8 rounded-lg shadow-xl interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">🔪 Phẫu thuật ngoài tim</h3>
                    <p class="text-gray-700">Nguy cơ biến chứng tim mạch cao. Cần phối hợp chặt chẽ đa chuyên khoa để duy trì huyết động ổn định.</p>
                </div>
            </div>
        </section>

        <section id="sources" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl md:text-5xl font-extrabold text-[#0f766e] mb-4 animated-child">Nguồn Tham Khảo</h2>
                <p class="max-w-3xl mx-auto text-lg text-slate-600 animated-child" style="--delay: 0.1s;">Nội dung được tổng hợp và đối chiếu từ các nguồn tài liệu và hướng dẫn thực hành lâm sàng uy tín.</p>
            </div>
            <div class="max-w-4xl mx-auto space-y-6 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child"><h3 class="text-xl font-semibold text-[#005f69] mb-2">1. Tài liệu nền tảng</h3><p class="text-gray-700">"Hẹp Van Hai Lá" - Nguyễn Lân Việt, Phạm Mạnh Hùng.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child" style="--delay: 0.1s;"><h3 class="text-xl font-semibold text-[#005f69] mb-2">2. Hướng dẫn AHA/ACC 2020</h3><p class="text-gray-700">Guideline for the Management of Patients With Valvular Heart Disease.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child" style="--delay: 0.2s;"><h3 class="text-xl font-semibold text-[#005f69] mb-2">3. Hướng dẫn ESC/EACTS 2021</h3><p class="text-gray-700">Guidelines for the management of valvular heart disease.</p></div>
            </div>
        </section>

        <footer class="text-center mt-16 pt-8 border-t border-gray-200">
            <p class="text-gray-500 text-sm">Tài liệu được tổng hợp và biên soạn bởi TEAMDRCAT dựa trên tài liệu chuẩn Y Hà Nội và các nguồn tài liệu Y Khoa uy tín phục vụ mục đích học tập và tham khảo.</p>
        </footer>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navButtons = document.querySelectorAll('.nav-button');
            const mobileNav = document.getElementById('mobile-nav');
            const contentSections = document.querySelectorAll('.content-section');

            function switchTab(targetId) {
                navButtons.forEach(button => button.classList.toggle('active', button.dataset.target === targetId));
                contentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.add('active');
                        section.classList.remove('hidden');
                    } else {
                        section.classList.remove('active');
                        section.classList.add('hidden');
                    }
                });
                if (mobileNav.value !== targetId) mobileNav.value = targetId;
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                const activeSection = document.getElementById(targetId);
                if(activeSection) {
                    triggerAnimations(activeSection);
                }
            }
            
            contentSections.forEach(section => {
                if (!section.classList.contains('active')) {
                    section.classList.add('hidden');
                }
            });

            navButtons.forEach(button => button.addEventListener('click', () => switchTab(button.dataset.target)));
            mobileNav.addEventListener('change', (e) => switchTab(e.target.value));

            const animationObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const parent = entry.target;
                        const children = parent.querySelectorAll('.animated-child');
                        children.forEach((child, index) => {
                            child.style.setProperty('--delay', `${index * 0.1}s`);
                            setTimeout(() => child.classList.add('visible'), 50);
                        });
                        animationObserver.unobserve(parent); 
                    }
                });
            }, { threshold: 0.2 });

            function triggerAnimations(container) {
                container.querySelectorAll('.animated-parent').forEach(parent => {
                    // Reset visibility before observing
                    parent.querySelectorAll('.animated-child').forEach(child => child.classList.remove('visible'));
                    animationObserver.observe(parent);
                });
            }

            triggerAnimations(document.querySelector('.content-section.active'));

            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetId = tab.dataset.target;
                    const parent = tab.closest('[data-tab-container]');
                    if (!parent) return;
                    parent.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const contentClass = parent.dataset.tabContainer === 'staging' ? '.staging-content' : '.etiology-content';
                    parent.querySelectorAll(contentClass).forEach(content => {
                        content.classList.toggle('hidden', content.id !== targetId);
                    });
                });
            });

            const wilkinsInputs = document.querySelectorAll('.wilkins-input');
            const wilkinsResultDiv = document.getElementById('wilkins-result');
            function calculateWilkinsScore() {
                let totalScore = 0;
                wilkinsInputs.forEach(input => totalScore += parseInt(input.value));
                let resultText = `Tổng điểm Wilkins: ${totalScore}. `;
                let bgColor = '';
                if (totalScore <= 8) {
                    resultText += "Hình thái tối ưu cho PMBC.";
                    bgColor = 'bg-green-100 text-green-800';
                } else if (totalScore <= 11) {
                    resultText += "Kết quả không tối ưu, cần cân nhắc.";
                    bgColor = 'bg-yellow-100 text-yellow-800';
                } else {
                    resultText += "Không nên nong van, nguy cơ cao.";
                    bgColor = 'bg-red-100 text-red-800';
                }
                wilkinsResultDiv.textContent = resultText;
                wilkinsResultDiv.className = `text-center font-bold text-lg p-3 rounded-md mt-2 ${bgColor}`;
            }
            wilkinsInputs.forEach(input => input.addEventListener('change', calculateWilkinsScore));
            calculateWilkinsScore();

            const severityCtx = document.getElementById('severityChart').getContext('2d');
            new Chart(severityCtx, {
                type: 'bar',
                data: {
                    labels: ['Hẹp Nhẹ', 'Hẹp Vừa', 'Hẹp Nặng'],
                    datasets: [
                        { label: 'MVA (cm²)', data: [1.8, 1.25, 0.8], backgroundColor: '#0f766e', yAxisID: 'y' },
                        { label: 'Chênh áp (mmHg)', data: [4, 7, 12], backgroundColor: '#f97316', yAxisID: 'y1' },
                        { label: 'PAPs (mmHg)', data: [25, 40, 60], backgroundColor: '#475569', yAxisID: 'y1' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    animation: { duration: 1000, easing: 'easeInOutQuart' },
                    plugins: { title: { display: true, text: 'Các thông số chính đánh giá mức độ nặng HHL', font: { size: 16 } } },
                    scales: {
                        y: { type: 'linear', display: true, position: 'left', title: { display: true, text: 'Diện tích van (cm²)' }, min: 0, max: 2.5 },
                        y1: { type: 'linear', display: true, position: 'right', title: { display: true, text: 'Áp lực (mmHg)' }, grid: { drawOnChartArea: false }, min: 0, max: 80 }
                    }
                }
            });

            document.querySelectorAll('.diagnostic-details-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const target = document.getElementById(btn.dataset.target);
                    if(target) target.classList.toggle('hidden');
                });
            });
        });
    </script>
</body>
</html>
