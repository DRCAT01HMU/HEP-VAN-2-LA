<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper-Infographic: Hẹp Van Hai Lá (Hiệu ứng Nâng cao)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Refined Teal and Warm Neutrals (Static & Animated) -->
    <!-- Application Structure Plan: A static, offline-first version based on the user-preferred classic theme. All AI-generated content is pre-rendered and embedded directly into the HTML. The focus is on enhancing visual engagement through advanced, staggered animations and more interactive hover effects, creating a "living document" feel without external dependencies. -->
    <!-- Visualization & Content Choices: All visualizations are retained but enhanced with more sophisticated animations. The pathophysiology cascade now features animated connectors. AI content is presented in styled, embedded blocks. This approach delivers a rich, interactive, and fully portable educational tool. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f7f9fc;
            color: #333;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            padding-bottom: 8px;
        }
        .nav-button.active, .nav-button:hover {
            color: #0c838f;
            border-bottom-color: #0c838f;
        }
        .tab-button.active {
            background-color: #0c838f;
            color: white;
        }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .chart-container {
            position: relative; width: 100%; max-width: 700px; margin-left: auto; margin-right: auto; height: 350px; max-height: 450px;
        }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        
        .animated-child {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            transition-delay: var(--delay, 0s);
        }
        .animated-child.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .interactive-card {
            transition: all 0.3s ease;
        }
        .interactive-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.08);
        }

        .cascade-connector {
            position: relative;
            height: 3rem;
            width: 2px;
            margin: -1rem auto;
            background-color: #cbd5e1;
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 0.5s ease-out;
            transition-delay: var(--delay, 0s);
        }
        .cascade-connector.visible {
            transform: scaleY(1);
        }
        .cascade-arrow {
            position: absolute;
            bottom: -1px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #cbd5e1;
        }
        .ai-content-box {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0 8px 8px 0;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4">
            <div class="flex items-center justify-between h-20">
                <h1 class="text-xl md:text-2xl font-bold text-[#005f69]">Hẹp Van Hai Lá</h1>
                <div class="hidden md:flex items-center space-x-8 text-base font-semibold text-gray-600">
                    <button class="nav-button active" data-target="overview">Tổng quan</button>
                    <button class="nav-button" data-target="diagnosis">Chẩn đoán</button>
                    <button class="nav-button" data-target="staging">Phân loại</button>
                    <button class="nav-button" data-target="treatment">Điều trị</button>
                    <button class="nav-button" data-target="special">Tình huống đặc biệt</button>
                    <button class="nav-button" data-target="sources">Nguồn</button>
                </div>
                <div class="md:hidden">
                    <select id="mobile-nav" class="bg-white border border-gray-300 rounded-md p-2 text-gray-700 focus:ring-2 focus:ring-[#0c838f]">
                        <option value="overview">Tổng quan</option>
                        <option value="diagnosis">Chẩn đoán</option>
                        <option value="staging">Phân loại</option>
                        <option value="treatment">Điều trị</option>
                        <option value="special">Tình huống đặc biệt</option>
                        <option value="sources">Nguồn</option>
                    </select>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <section id="overview" class="content-section active">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Sinh Lý Bệnh Hẹp Van Hai Lá</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Hẹp van hai lá khởi đầu một chuỗi các biến đổi huyết động bất lợi, ảnh hưởng ngược dòng từ van tim đến phổi và cuối cùng là toàn bộ hệ tuần hoàn.</p>
                <div class="ai-content-box max-w-3xl mx-auto text-left animated-child" style="--delay: 0.2s;">
                    <h4 class="font-bold text-sky-700">✨ Giải thích đơn giản cho bệnh nhân</h4>
                    <p class="text-gray-700 mt-2">Chào bạn, hãy tưởng tượng van hai lá của tim giống như một cánh cửa giữa hai buồng tim. Bình thường, nó mở ra dễ dàng để máu đi qua. Khi bị "hẹp van hai lá", cánh cửa này bị kẹt và cứng lại, khiến máu khó đi qua hơn. Điều này làm cho buồng tim phía trên phải làm việc vất vả hơn, lâu ngày sẽ bị mệt và giãn ra. Áp lực tăng lên này có thể dội ngược lại phổi, gây ra cảm giác khó thở, đặc biệt là khi bạn đi nhanh hay leo cầu thang. Mục tiêu điều trị là giúp cánh cửa này hoạt động tốt hơn để tim bạn đỡ vất vả và bạn cảm thấy khỏe hơn.</p>
                </div>
            </div>
            
            <div id="pathophysiology-cascade" class="space-y-0 mb-16 animated-parent">
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child">
                    <div class="text-2xl mb-2">1️⃣</div>
                    <h3 class="font-semibold text-gray-800">Hẹp Van</h3>
                    <p class="text-sm text-gray-500">Diện tích van < 2 cm²</p>
                </div>
                <div class="cascade-connector animated-child" style="--delay: 0.2s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.3s;">
                    <div class="text-2xl mb-2">2️⃣</div>
                    <h3 class="font-semibold text-gray-800">Tăng Áp Lực Nhĩ Trái</h3>
                    <p class="text-sm text-gray-500">Gây giãn nhĩ, nguy cơ rung nhĩ</p>
                </div>
                <div class="cascade-connector animated-child" style="--delay: 0.5s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.6s;">
                    <div class="text-2xl mb-2">3️⃣</div>
                    <h3 class="font-semibold text-gray-800">Tăng Áp Phổi</h3>
                    <p class="text-sm text-gray-500">Gây khó thở, sung huyết phổi</p>
                </div>
                <div class="cascade-connector animated-child" style="--delay: 0.8s;"><div class="cascade-arrow"></div></div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center interactive-card animated-child" style="--delay: 0.9s;">
                    <div class="text-2xl mb-2">4️⃣</div>
                    <h3 class="font-semibold text-gray-800">Suy Thất Phải</h3>
                    <p class="text-sm text-gray-500">Gây phù, gan to, tĩnh mạch cổ nổi</p>
                </div>
            </div>
        </section>

        <section id="diagnosis" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Tiếp Cận Chẩn Đoán Đa Mô Thức</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Chẩn đoán hiện đại không chỉ xác định bệnh mà còn phải làm rõ nguyên nhân, mức độ nặng và ảnh hưởng lên toàn bộ trái tim để định hướng chiến lược điều trị cá thể hóa.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0s;">
                    <div class="flex items-center mb-4"><div class="text-4xl mr-4">🩺</div><h3 class="text-2xl font-semibold text-[#005f69]">Lâm sàng & Nghe tim</h3></div>
                    <p class="text-gray-600">Khó thở khi gắng sức là triệu chứng cốt lõi. Nghe tim có tam chứng kinh điển: T1 đanh, clac mở van, rung tâm trương.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <div class="flex items-center mb-4"><div class="text-4xl mr-4">🖥️</div><h3 class="text-2xl font-semibold text-[#005f69]">Siêu âm tim 2D/3D</h3></div>
                    <p class="text-gray-600 mb-4">Siêu âm 3D qua thực quản (3D-TEE) là "tiêu chuẩn vàng mới" để đo diện tích van (MVA), khắc phục hạn chế của 2D.</p>
                    <button class="font-semibold text-[#0c838f] diagnostic-details-btn" data-target="echo-details">Xem chi tiết 2D vs 3D →</button>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.2s;">
                    <div class="flex items-center mb-4"><div class="text-4xl mr-4">🏃‍♂️</div><h3 class="text-2xl font-semibold text-[#005f69]">Nghiệm pháp gắng sức</h3></div>
                    <p class="text-gray-600">Bộc lộ các trường hợp nặng tiềm ẩn ở bệnh nhân ít triệu chứng bằng cách đánh giá khách quan đáp ứng huyết động.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.3s;">
                    <div class="flex items-center mb-4"><div class="text-4xl mr-4">🧲</div><h3 class="text-2xl font-semibold text-[#005f69]">Cộng hưởng từ (MRI)</h3></div>
                    <p class="text-gray-600">Đánh giá chính xác chức năng thất và phát hiện tổn thương xơ hóa cơ tim (LGE), một yếu tố tiên lượng quan trọng.</p>
                </div>
            </div>
            <div id="echo-details" class="hidden mt-8 bg-gray-50 p-6 rounded-lg">
                <h4 class="text-xl font-bold text-center mb-4">Tại sao Siêu âm 3D vượt trội hơn 2D?</h4>
                <p class="text-center mb-6">Siêu âm 2D thường cắt chéo qua lỗ van, làm diện tích đo được lớn hơn thực tế. Siêu âm 3D cho phép tái tạo hình ảnh từ góc nhìn của nhĩ trái và xác định chính xác mặt phẳng hẹp nhất.</p>
                <div class="flex justify-around items-center">
                    <div class="text-center"><p class="font-semibold">Siêu âm 2D</p><div class="w-32 h-32 border-2 border-dashed border-gray-400 flex items-center justify-center rounded-lg mt-2"><div class="w-20 h-10 bg-gray-300 transform -skew-x-12 flex items-center justify-center"><p class="text-sm">MVA = 1.6 cm²</p></div></div><p class="text-xs mt-2 text-red-600">Dễ đánh giá quá mức</p></div>
                    <div class="text-center"><p class="font-semibold">Siêu âm 3D</p><div class="w-32 h-32 border-2 border-solid border-[#0c838f] flex items-center justify-center rounded-lg mt-2 bg-teal-50"><div class="w-16 h-8 bg-[#0c838f] rounded-full flex items-center justify-center text-white"><p class="text-sm">1.4 cm²</p></div></div><p class="text-xs mt-2 text-green-600">Chính xác hơn</p></div>
                </div>
            </div>
        </section>

        <section id="staging" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Phân Giai Đoạn và Mức Độ Nặng</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Hệ thống phân giai đoạn A-D của AHA/ACC giúp chuẩn hóa việc đánh giá và định hướng can thiệp một cách chủ động.</p>
            </div>
            <div class="flex flex-col md:flex-row gap-8 animated-parent" data-tab-container="staging">
                <div class="md:w-1/3 animated-child" style="--delay: 0s;">
                    <div class="flex flex-col bg-white rounded-lg shadow-lg overflow-hidden">
                        <button class="tab-button p-4 text-left w-full text-lg active" data-target="stageA"><strong>A:</strong> Có nguy cơ</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageB"><strong>B:</strong> Tiến triển</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageC"><strong>C:</strong> Nặng, không triệu chứng</button>
                        <button class="tab-button p-4 text-left w-full text-lg" data-target="stageD"><strong>D:</strong> Nặng, có triệu chứng</button>
                    </div>
                </div>
                <div class="md:w-2/3 bg-white p-8 rounded-lg shadow-lg animated-child" style="--delay: 0.1s;">
                    <div id="stageA" class="staging-content">
                        <h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn A: At Risk</h3>
                        <p><strong>Đặc điểm:</strong> Có yếu tố nguy cơ (tiền sử thấp tim) nhưng van bình thường. <strong>Xử trí:</strong> Theo dõi, phòng thấp tái phát.</p>
                    </div>
                    <div id="stageB" class="staging-content hidden">
                        <h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn B: Progressive</h3>
                        <p><strong>Đặc điểm:</strong> HHL nhẹ đến vừa (MVA > 1.5 cm²). <strong>Xử trí:</strong> Theo dõi siêu âm tim định kỳ (1-5 năm).</p>
                    </div>
                    <div id="stageC" class="staging-content hidden">
                        <h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn C: Asymptomatic Severe</h3>
                        <p><strong>Đặc điểm:</strong> HHL khít (MVA ≤ 1.5 cm²). <strong>Xử trí:</strong> Theo dõi sát. Cân nhắc can thiệp sớm nếu có yếu tố nguy cơ cao.</p>
                        <div class="ai-content-box">
                            <h4 class="font-bold text-sky-700">✨ Tình huống lâm sàng</h4>
                            <p class="text-gray-700 mt-2">Bệnh nhân nữ, 38 tuổi, tiền sử thấp tim không rõ ràng, đến khám sức khỏe định kỳ. Bệnh nhân hoàn toàn không có triệu chứng, có thể đi bộ 2 tầng lầu không mệt. Khám tim nghe T1 đanh, rung tâm trương 3/6 ở mỏm. Siêu âm tim: van hai lá dày, dính mép, mở dạng vòm. MVA (đo planimetry 3D) = 1.3 cm², chênh áp trung bình 9 mmHg. PAPs lúc nghỉ 45 mmHg. Chức năng thất trái bình thường. <br><strong>Câu hỏi:</strong> Bệnh nhân này thuộc giai đoạn nào của HHL? Có chỉ định can thiệp ở thời điểm hiện tại không? Thảo luận các yếu tố cần cân nhắc.</p>
                        </div>
                    </div>
                    <div id="stageD" class="staging-content hidden">
                        <h3 class="font-bold text-2xl text-[#005f69] mb-3">Giai đoạn D: Symptomatic Severe</h3>
                        <p><strong>Đặc điểm:</strong> HHL khít (MVA ≤ 1.5 cm²) và có triệu chứng. <strong>Xử trí:</strong> Có chỉ định can thiệp rõ ràng.</p>
                        <div class="ai-content-box">
                            <h4 class="font-bold text-sky-700">✨ Tình huống lâm sàng</h4>
                            <p class="text-gray-700 mt-2">Bệnh nhân nam, 45 tuổi, đến khám vì khó thở khi gắng sức ngày càng tăng trong 6 tháng qua (NYHA III). Bệnh nhân không thể làm việc nặng như trước. Nghe tim có rung tâm trương rõ, T1 đanh. Siêu âm tim: HHL khít do thấp, MVA = 1.1 cm², chênh áp trung bình 14 mmHg, PAPs 65 mmHg. Điểm Wilkins = 7. Không có hở van hai lá đáng kể và không có huyết khối trong nhĩ trái. <br><strong>Câu hỏi:</strong> Bệnh nhân này có chỉ định can thiệp tuyệt đối. Lựa chọn can thiệp tối ưu cho bệnh nhân này là gì (PMBC hay phẫu thuật)? Tại sao?</p>
                        </div>
                    </div>
                </div>
            </div>
             <div class="mt-12 bg-white p-6 rounded-lg shadow-lg animated-parent">
                <h3 class="text-3xl font-bold text-center text-[#0c838f] mb-6 animated-child">Đánh giá Mức độ nặng trên Siêu âm</h3>
                <div class="chart-container animated-child" style="--delay: 0.1s;">
                    <canvas id="severityChart"></canvas>
                </div>
            </div>
        </section>
        
        <section id="treatment" class="content-section">
             <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Chiến Lược Điều Trị Toàn Diện</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Quyết định điều trị là một quá trình phức tạp, được cá thể hóa và đưa ra bởi "Nhóm Tim Mạch" (Heart Team).</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Nội khoa & Chống đông</h3>
                    <p class="mb-4">Dùng thuốc lợi tiểu, chẹn beta để kiểm soát triệu chứng. Lựa chọn thuốc chống đông khi có rung nhĩ là quyết định then chốt.</p>
                    <div class="ai-content-box">
                        <h4 class="font-bold text-sky-700">✨ Giải thích đơn giản cho bệnh nhân</h4>
                        <p class="text-gray-700 mt-2">Khi bạn bị hẹp van hai lá và tim đập không đều (rung nhĩ), máu dễ bị ứ lại và tạo thành các cục máu đông nhỏ, có thể gây đột quỵ. Để ngăn ngừa, bác sĩ sẽ kê thuốc chống đông. Với bệnh của bạn, loại thuốc 'kháng Vitamin K' (như Warfarin) là an toàn và hiệu quả nhất đã được chứng minh. Các loại thuốc mới hơn chưa được nghiên cứu kỹ cho tình trạng này. Vì vậy, việc uống thuốc đều đặn và kiểm tra máu thường xuyên là rất quan trọng để giữ bạn an toàn.</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">Nong van bằng bóng (PMBC)</h3>
                    <p class="mb-4">Là lựa chọn hàng đầu cho HHL do thấp có hình thái van phù hợp. Sử dụng thang điểm Wilkins để đánh giá.</p>
                    <div id="wilkins-calculator" class="space-y-2">
                        <div class="grid grid-cols-2 gap-4">
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Di động: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Độ dày: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Vôi hóa: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                             <select class="wilkins-input w-full p-2 border rounded-md text-sm"><option value="1">Dưới van: 1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                        </div>
                        <div id="wilkins-result" class="text-center font-bold text-lg p-3 rounded-md mt-2"></div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="special" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Quản Lý Trong Các Tình Huống Đặc Biệt</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Việc quản lý HHL cần được điều chỉnh cẩn thận ở một số quần thể đặc biệt.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 animated-parent">
                <div class="bg-white p-8 rounded-lg shadow-xl interactive-card animated-child" style="--delay: 0s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">🤰 Hẹp van hai lá và Thai kỳ</h3>
                    <p class="text-gray-700">Tình trạng nguy cơ rất cao do thay đổi sinh lý của thai kỳ có thể làm bệnh nhân mất bù nhanh chóng.</p>
                    <div class="mt-4 bg-red-50 border-l-4 border-red-400 p-4 rounded"><strong class="text-red-800">Nguyên tắc vàng:</strong> Tư vấn và can thiệp (PMBC) <strong>TRƯỚC KHI</strong> mang thai nếu HHL khít.</div>
                </div>
                <div class="bg-white p-8 rounded-lg shadow-xl interactive-card animated-child" style="--delay: 0.1s;">
                    <h3 class="text-2xl font-bold text-[#005f69] mb-4">🔪 Hẹp van hai lá và Phẫu thuật ngoài tim</h3>
                    <p class="text-gray-700">Bệnh nhân có nguy cơ biến chứng tim mạch cao. Cần phối hợp chặt chẽ giữa các chuyên khoa.</p>
                    <div class="mt-4 bg-blue-50 border-l-4 border-blue-400 p-4 rounded"><strong class="text-blue-800">Mục tiêu chính trong mổ:</strong> Duy trì huyết động ổn định, tránh nhịp tim nhanh và quá tải dịch.</div>
                </div>
            </div>
        </section>

        <section id="sources" class="content-section">
            <div class="text-center mb-12 animated-parent">
                <h2 class="text-4xl font-bold text-[#0c838f] mb-4 animated-child">Nguồn Tham Khảo Chính</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 animated-child" style="--delay: 0.1s;">Nội dung của infographic này được tổng hợp và đối chiếu từ các nguồn tài liệu và hướng dẫn thực hành lâm sàng uy tín.</p>
            </div>
            <div class="max-w-4xl mx-auto space-y-6 animated-parent">
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child" style="--delay: 0s;"><h3 class="text-xl font-semibold text-[#005f69] mb-2">1. Tài liệu nền tảng</h3><p class="text-gray-700">"Hẹp Van Hai Lá" - Nguyễn Lân Việt, Phạm Mạnh Hùng.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child" style="--delay: 0.1s;"><h3 class="text-xl font-semibold text-[#005f69] mb-2">2. Hướng dẫn AHA/ACC 2020</h3><p class="text-gray-700">Guideline for the Management of Patients With Valvular Heart Disease.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-lg animated-child" style="--delay: 0.2s;"><h3 class="text-xl font-semibold text-[#005f69] mb-2">3. Hướng dẫn ESC/EACTS 2021</h3><p class="text-gray-700">Guidelines for the management of valvular heart disease.</p></div>
            </div>
        </section>

        <footer class="text-center mt-16 pt-8 border-t border-gray-200">
            <p class="text-gray-500 text-sm">Tài liệu được tổng hợp và biên soạn bởi TEAMDRCAT dựa trên tài liệu chuẩn Y Hà Nội và các nguồn tài liệu Y Khoa uy tín phục vụ mục đích học tập và tham khảo.</p>
        </footer>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navButtons = document.querySelectorAll('.nav-button');
            const mobileNav = document.getElementById('mobile-nav');
            const contentSections = document.querySelectorAll('.content-section');

            function switchTab(targetId) {
                navButtons.forEach(button => button.classList.toggle('active', button.dataset.target === targetId));
                contentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.add('active');
                        section.classList.remove('hidden');
                    } else {
                        section.classList.remove('active');
                        section.classList.add('hidden');
                    }
                });
                if (mobileNav.value !== targetId) mobileNav.value = targetId;
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Trigger animations for the newly displayed section
                const activeSection = document.getElementById(targetId);
                if(activeSection) {
                    triggerAnimations(activeSection);
                }
            }
            
            contentSections.forEach(section => {
                if (!section.classList.contains('active')) {
                    section.classList.add('hidden');
                }
            });

            navButtons.forEach(button => button.addEventListener('click', () => switchTab(button.dataset.target)));
            mobileNav.addEventListener('change', (e) => switchTab(e.target.value));

            // Animation logic
            const animationObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const parent = entry.target;
                        const children = parent.querySelectorAll('.animated-child');
                        children.forEach((child, index) => {
                            // Reset animation for re-triggering if needed, though unobserve is better for performance
                            child.classList.remove('visible');
                            child.style.setProperty('--delay', `${index * 0.1}s`);
                            // Use a timeout to ensure the class is re-added after the reset
                            setTimeout(() => child.classList.add('visible'), 50);
                        });
                        // For static page, unobserving after first animation is good for performance
                        // animationObserver.unobserve(parent); 
                    }
                });
            }, { threshold: 0.2 });

            function triggerAnimations(container) {
                const parents = container.querySelectorAll('.animated-parent');
                if (parents.length > 0) {
                    parents.forEach(parent => animationObserver.observe(parent));
                }
            }

            // Initial trigger for the first active section
            triggerAnimations(document.querySelector('.content-section.active'));

            // Tab handlers
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetId = tab.dataset.target;
                    const parent = tab.closest('[data-tab-container]');
                    if (!parent) return;
                    parent.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const contentClass = parent.dataset.tabContainer === 'staging' ? '.staging-content' : '.etiology-content';
                    parent.querySelectorAll(contentClass).forEach(content => {
                        content.classList.toggle('hidden', content.id !== targetId);
                    });
                });
            });

            // Wilkins Score Calculator
            const wilkinsInputs = document.querySelectorAll('.wilkins-input');
            const wilkinsResultDiv = document.getElementById('wilkins-result');
            function calculateWilkinsScore() {
                let totalScore = 0;
                wilkinsInputs.forEach(input => totalScore += parseInt(input.value));
                let resultText = `Tổng điểm Wilkins: ${totalScore}. `;
                let bgColor = '';
                if (totalScore <= 8) {
                    resultText += "Hình thái tối ưu cho PMBC.";
                    bgColor = 'bg-green-100 text-green-800';
                } else if (totalScore <= 11) {
                    resultText += "Kết quả không tối ưu, cần cân nhắc.";
                    bgColor = 'bg-yellow-100 text-yellow-800';
                } else {
                    resultText += "Không nên nong van, nguy cơ cao.";
                    bgColor = 'bg-red-100 text-red-800';
                }
                wilkinsResultDiv.textContent = resultText;
                wilkinsResultDiv.className = `text-center font-bold text-lg p-3 rounded-md mt-2 ${bgColor}`;
            }
            wilkinsInputs.forEach(input => input.addEventListener('change', calculateWilkinsScore));
            calculateWilkinsScore();

            // Chart.js
            const severityCtx = document.getElementById('severityChart').getContext('2d');
            new Chart(severityCtx, {
                type: 'bar',
                data: {
                    labels: ['Hẹp Nhẹ', 'Hẹp Vừa', 'Hẹp Nặng'],
                    datasets: [
                        { label: 'MVA (cm²)', data: [1.8, 1.25, 0.8], backgroundColor: '#0c838f', yAxisID: 'y' },
                        { label: 'Chênh áp (mmHg)', data: [4, 7, 12], backgroundColor: '#f97316', yAxisID: 'y1' },
                        { label: 'PAPs (mmHg)', data: [25, 40, 60], backgroundColor: '#6b7280', yAxisID: 'y1' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    },
                    plugins: { title: { display: true, text: 'Các thông số chính đánh giá mức độ nặng HHL', font: { size: 16 } } },
                    scales: {
                        y: { type: 'linear', display: true, position: 'left', title: { display: true, text: 'Diện tích van (cm²)' }, min: 0, max: 2.5 },
                        y1: { type: 'linear', display: true, position: 'right', title: { display: true, text: 'Áp lực (mmHg)' }, grid: { drawOnChartArea: false }, min: 0, max: 80 }
                    }
                }
            });

            // Details button
            document.querySelectorAll('.diagnostic-details-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const target = document.getElementById(btn.dataset.target);
                    if(target) target.classList.toggle('hidden');
                });
            });
        });
    </script>
</body>
</html>
